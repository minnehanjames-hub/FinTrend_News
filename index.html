<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FinTrend News</title>
  <meta name="description" content="Sell-side style market briefings. 4× weekly. Fast, clean, no noise." />
  <link rel="icon" type="image/png" href="assets/img/favicon.png" />
  <link rel="apple-touch-icon" href="assets/img/favicon.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#050816;
      --bg2:#0b1020;
      --card:rgba(15,23,42,.78);
      --card2:rgba(2,6,23,.38);
      --border:rgba(148,163,184,.28);
      --text:#f9fafb;
      --muted:#9ca3af;
      --accent:#f4c15d;
      --accent2:rgba(244,193,93,.12);
      --radius:18px;
      --radius2:24px;
      --shadow:0 18px 45px rgba(15,23,42,.75);
      --max:1150px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      color:var(--text);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      line-height:1.6;
      min-height:100vh;
      background-image:
        radial-gradient(circle at top, rgba(17,24,39,.78) 0, rgba(2,6,23,.82) 45%, rgba(0,0,0,.92) 100%),
        url("assets/img/bg-candles.png");
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      background-attachment:fixed;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      background:linear-gradient(to bottom, rgba(2,6,23,.18), rgba(2,6,23,.35) 40%, rgba(2,6,23,.60));
      pointer-events:none;
      z-index:-1;
    }
    a{color:#e5e7eb;text-decoration:none}
    a:hover{color:var(--accent)}
    .page{max-width:var(--max); margin:16px auto 56px; padding:0 16px 36px}

    .top-header{
      position:sticky; top:0; z-index:9999;
      border-radius:var(--radius2);
      background:linear-gradient(135deg, rgba(15,23,42,.96), rgba(15,23,42,.82));
      border:1px solid rgba(148,163,184,.25);
      box-shadow:0 8px 24px rgba(15,23,42,.6);
      overflow:hidden;
      margin-bottom:14px;
      backdrop-filter:blur(6px);
    }
    .ticker-row{
      padding:4px 18px;
      background:radial-gradient(circle at top, #020617 0, #000 65%);
      border-bottom:1px solid rgba(148,163,184,.35);
    }
    .ticker-row .tradingview-widget-container{height:28px}

    .header-main{
      display:grid;
      grid-template-columns:auto 1fr auto;
      align-items:center;
      padding:18px 22px 20px;
      gap:14px;
    }
    .logo-img{height:56px;width:auto;display:block}
    .header-center{text-align:center}
    .brand-title{
      font-family:"Playfair Display",serif;
      font-size:32px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--accent);
      line-height:1.05;
    }
    .brand-subtitle{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.14em;
      text-transform:uppercase;
    }
    .header-right{
      display:flex;
      align-items:center;
      gap:14px;
      justify-self:end;
      flex-wrap:wrap;
    }
    .header-link{
      font-size:12px;
      color:var(--muted);
      letter-spacing:.08em;
      text-transform:uppercase;
    }
    .header-link:hover{color:var(--text)}
    .subscribe-btn{
      padding:7px 16px;
      border-radius:999px;
      background:var(--accent);
      color:#000;
      font-size:12px;
      font-weight:900;
      letter-spacing:.08em;
      text-transform:uppercase;
      box-shadow:0 10px 30px rgba(244,193,93,.15);
    }
    .subscribe-btn:hover{background:#f7d680; transform:translateY(-1px)}
    .social-icons{display:flex; gap:10px}
    .social-icon{font-size:14px; color:var(--muted)}
    .social-icon:hover{color:var(--accent)}
    @media (max-width:830px){
      .header-main{grid-template-columns:1fr; row-gap:10px; justify-items:flex-start; padding:14px 18px 18px}
      .header-center{text-align:left}
      .brand-title{font-size:26px}
      .logo-img{height:46px}
    }

    .card{
      border-radius:var(--radius2);
      border:1px solid rgba(148,163,184,.22);
      background:var(--card);
      box-shadow:var(--shadow);
      overflow:hidden;
      backdrop-filter:blur(8px);
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:0;
      background:radial-gradient(circle at top left, rgba(244,193,93,.10), transparent 55%);
      pointer-events:none;
    }

    .hero{min-height:72vh; display:grid; place-items:center; padding:20px 0 10px}
    .hero-inner{
      position:relative; z-index:1;
      padding:22px 22px 18px;
      display:grid;
      grid-template-columns:1.2fr .8fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width:920px){ .hero-inner{grid-template-columns:1fr} }
    .kicker{
      font-size:11px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.18em;
      margin-bottom:8px;
    }
    .hero-title{
      font-family:"Playfair Display",serif;
      font-size:40px;
      line-height:1.08;
      margin-bottom:10px;
    }
    .hero-title span{
      background:linear-gradient(135deg, #fef3c7, #fbbf24, #fb923c);
      -webkit-background-clip:text;
      color:transparent;
    }
    .hero-sub{color:#e5e7eb; font-size:15px; max-width:680px; margin-bottom:14px}
    .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    .btn{
      font-size:12px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.45);
      background:rgba(2,6,23,.40);
      color:var(--text);
      text-transform:uppercase;
      letter-spacing:.14em;
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      transition:.18s ease;
    }
    .btn:hover{transform:translateY(-1px); border-color:rgba(244,193,93,.35)}
    .btn.primary{background:var(--accent); color:#000; border-color:var(--accent); font-weight:900}
    .btn.primary:hover{background:#f7d680}

    .aside{
      border-radius:var(--radius);
      border:1px solid rgba(148,163,184,.24);
      background:rgba(2,6,23,.35);
      padding:14px 14px 12px;
      position:relative;
      z-index:1;
    }
    .aside-title{
      font-size:11px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.18em;
      margin-bottom:10px;
    }
    .grid2{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px}
    .tile{
      border-radius:16px;
      border:1px solid rgba(148,163,184,.22);
      background:rgba(15,23,42,.65);
      padding:10px 10px 9px;
      transition:.18s ease;
    }
    .tile:hover{transform:translateY(-1px); border-color:rgba(244,193,93,.35); background:rgba(15,23,42,.78)}
    .tile-top{display:flex; justify-content:space-between; align-items:baseline; gap:8px; margin-bottom:6px}
    .label{font-size:10px; letter-spacing:.18em; text-transform:uppercase; color:var(--muted)}
    .chip{
      font-size:10px; letter-spacing:.12em; text-transform:uppercase;
      padding:3px 8px; border-radius:999px;
      border:1px solid rgba(148,163,184,.28);
      background:rgba(2,6,23,.35);
      color:var(--muted);
      white-space:nowrap;
    }
    .note{margin-top:10px; font-size:11px; color:var(--muted)}
    .scroll-cue{display:flex; justify-content:center; margin-top:14px; opacity:.95; position:relative; z-index:1}
    .scroll-link{
      color:var(--muted);
      border:1px solid rgba(148,163,184,.24);
      background:rgba(2,6,23,.35);
      padding:10px 14px;
      border-radius:999px;
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      display:inline-flex;
      align-items:center;
      gap:10px;
      transition:.18s ease;
    }
    .scroll-link:hover{transform:translateY(-1px); border-color:rgba(244,193,93,.35); color:var(--text)}

    .panel{
      background:rgba(15,23,42,.90);
      border-radius:var(--radius2);
      border:1px solid rgba(148,163,184,.28);
      box-shadow:var(--shadow);
      padding:20px 20px 18px;
      position:relative;
      overflow:hidden;
      margin-top:18px;
      backdrop-filter:blur(6px);
    }
    .panel::before{
      content:"";
      position:absolute; inset:0;
      background:radial-gradient(circle at top left, rgba(250,204,21,.07), transparent 55%);
      pointer-events:none;
    }
    .panel > *{position:relative; z-index:1}
    .panel-head{display:flex; justify-content:space-between; align-items:baseline; gap:12px; margin-bottom:16px}
    .ptitle{font-size:13px; text-transform:uppercase; letter-spacing:.16em; color:var(--muted)}
    .psub{font-size:11px; color:var(--muted)}
    .ptime{font-size:11px; color:var(--accent); text-transform:uppercase; letter-spacing:.14em}

    .watch-row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:12px}
    .watch-btn{
      border-radius:999px;
      border:1px solid rgba(148,163,184,.30);
      background:rgba(2,6,23,.40);
      color:var(--text);
      padding:8px 12px;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
      transition:.18s ease;
    }
    .watch-btn:hover{transform:translateY(-1px); border-color:rgba(244,193,93,.35)}
    .watch-btn.active{background:rgba(244,193,93,.14); border-color:rgba(244,193,93,.55); color:var(--accent)}

    .subscribe-wrap{
      display:grid;
      grid-template-columns:1.1fr .9fr;
      gap:16px;
      align-items:center;
    }
    @media (max-width:900px){ .subscribe-wrap{grid-template-columns:1fr} }
    .subscribe-card{
      border-radius:var(--radius2);
      border:1px solid rgba(244,193,93,.28);
      background:linear-gradient(135deg, rgba(244,193,93,.10), rgba(2,6,23,.35));
      box-shadow:0 18px 50px rgba(244,193,93,.08);
      padding:18px 18px 16px;
    }
    .subscribe-title{
      font-family:"Playfair Display",serif;
      font-size:26px;
      line-height:1.1;
      margin-bottom:6px;
    }
    .subscribe-sub{color:#e5e7eb; font-size:13px; margin-bottom:12px}
    .bullets{display:grid; gap:8px; margin-top:10px}
    .b{display:flex; gap:10px; align-items:flex-start}
    .dot{width:9px; height:9px; border-radius:999px; margin-top:5px; background:rgba(244,193,93,.95); box-shadow:0 0 0 5px rgba(244,193,93,.12); flex:0 0 auto}
    .btxt{color:var(--muted); font-size:12px; line-height:1.45}

    .form{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-start;
      padding:16px;
      border-radius:20px;
      border:1px solid rgba(148,163,184,.28);
      background:rgba(2,6,23,.32);
    }
    .input{
      flex:1 1 220px;
      min-width:220px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.45);
      background:#020617;
      color:#f9fafb;
      font-size:12px;
      outline:none;
    }
    .input:focus{border-color:rgba(244,193,93,.55); box-shadow:0 0 0 4px rgba(244,193,93,.10)}
    .submit{
      padding:12px 16px;
      border-radius:999px;
      border:none;
      background:var(--accent);
      color:#000;
      font-size:12px;
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;
      cursor:pointer;
      transition:.18s ease;
      white-space:nowrap;
    }
    .submit:hover{background:#f7d680; transform:translateY(-1px)}
    .fineprint{margin-top:10px; font-size:11px; color:var(--muted)}

    footer{
      margin-top:28px;
      font-size:11px;
      color:var(--muted);
      text-align:center;
      opacity:.95;
    }
    footer a{color:var(--accent)}
    footer a:hover{text-decoration:underline}

    .modal-backdrop{
      position:fixed; inset:0;
      background:rgba(0,0,0,.6);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:99999;
      padding:14px;
    }
    .modal-backdrop.active{display:flex}
    .modal-window{
      background:rgba(15,23,42,.97);
      border-radius:24px;
      border:1px solid rgba(148,163,184,.35);
      box-shadow:0 18px 45px rgba(15,23,42,.8);
      max-width:440px;
      width:100%;
      padding:22px 22px 18px;
      position:relative;
    }
    .modal-close{
      position:absolute; top:10px; right:12px;
      border:none; background:transparent;
      color:#9ca3af; font-size:20px; cursor:pointer;
    }
    .modal-kicker{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.18em;
      color:#9ca3af;
      margin-bottom:4px;
    }
    .modal-title{
      font-family:"Playfair Display",serif;
      font-size:22px;
      margin-bottom:6px;
      color:#f9fafb;
    }
    .modal-subtitle{font-size:13px; color:#d1d5db; margin-bottom:12px}
    .modal-row{display:flex; flex-wrap:wrap; gap:10px; margin-top:10px}
    .mbtn-primary,.mbtn-secondary{
      border-radius:999px;
      font-size:12px;
      padding:10px 16px;
      text-transform:uppercase;
      letter-spacing:.12em;
      cursor:pointer;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      transition:.18s ease;
    }
    .mbtn-primary{border:none; background:var(--accent); color:#000; font-weight:900}
    .mbtn-primary:hover{background:#f7d680; transform:translateY(-1px)}
    .mbtn-secondary{border:1px solid rgba(148,163,184,.5); background:transparent; color:#9ca3af}
    .mbtn-secondary:hover{border-color:var(--accent); color:var(--accent); transform:translateY(-1px)}
    .field{
      width:100%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.4);
      background:#020617;
      color:#f9fafb;
      font-size:12px;
      outline:none;
    }
    .field:focus{border-color:rgba(244,193,93,.55); box-shadow:0 0 0 4px rgba(244,193,93,.10)}
  </style>
</head>

<body>
  <div class="page">
    <header class="top-header">
      <div class="ticker-row">
        <div class="tradingview-widget-container">
          <script src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
{
  "symbols": [
    { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500" },
    { "proName": "NASDAQ:NDX", "title": "Nasdaq 100" },
    { "proName": "DJI", "title": "Dow 30" },
    { "proName": "RUSSELL:RTY", "title": "Russell 2000" },
    { "proName": "OANDA:EURUSD", "title": "EURUSD" },
    { "proName": "COINBASE:BTCUSD", "title": "BTC" },
    { "proName": "OANDA:WTICOUSD", "title": "WTI Crude" },
    { "proName": "OANDA:XAUUSD", "title": "Gold" }
  ],
  "colorTheme": "dark",
  "isTransparent": true,
  "displayMode": "adaptive",
  "locale": "en"
}
          </script>
        </div>
      </div>

      <div class="header-main">
        <div>
          <img src="assets/img/FTN-logo.png" alt="FinTrend News" class="logo-img" />
        </div>

        <div class="header-center">
          <h1 class="brand-title">FinTrend News</h1>
          <div class="brand-subtitle">4x weekly market briefings</div>
        </div>

        <div class="header-right">
          <a href="#" class="header-link" id="open-auth-modal">Sign In</a>
          <a href="#" class="header-link" id="signout-link" style="display:none;">Sign Out</a>
          <span class="header-link" id="user-chip" style="display:none;"></span>

          <a href="#subscribe" class="subscribe-btn">Subscribe</a>
          <a href="#" class="header-link" id="open-premium-modal">Premium</a>

          <div class="social-icons">
            <a href="https://www.instagram.com/fintrendnews?igsh=MXZkdXlhbW02bmUwMA==" target="_blank" rel="noopener" class="social-icon">IG</a>
            <a href="https://linkedin.com" target="_blank" rel="noopener" class="social-icon">in</a>
          </div>
        </div>
      </div>
    </header>

    <section class="hero">
      <div class="card">
        <div class="hero-inner">
          <div>
            <div class="kicker">Market Newsletter</div>
            <h2 class="hero-title">Your <span>sell-side style</span> market brief — without the noise.</h2>
            <p class="hero-sub">Macro drivers, positioning, catalysts — clean and fast. Built for a quick scan, then a deeper read when you want it.</p>

            <div class="actions">
              <a class="btn primary" href="#subscribe">Get Free Email</a>
              <a class="btn" href="archive.html">Open Archive</a>
              <a class="btn" href="#watch">Live Watchlist</a>
              <a class="btn" href="#premium">Premium Tools</a>
            </div>

            <div class="note">Scroll for live charts, premium tools, and the subscribe card.</div>
          </div>

          <aside class="aside">
            <div class="aside-title">Today at a glance</div>

            <div class="grid2">
              <div class="tile">
                <div class="tile-top">
                  <div class="label">S&P 500</div><div class="chip">Benchmark</div>
                </div>
                <div class="tradingview-widget-container">
                  <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
{ "symbol": "FOREXCOM:SPXUSD", "width": "100%", "colorTheme": "dark", "isTransparent": true, "locale": "en" }
                  </script>
                </div>
              </div>

              <div class="tile">
                <div class="tile-top">
                  <div class="label">Nasdaq 100</div><div class="chip">Growth</div>
                </div>
                <div class="tradingview-widget-container">
                  <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
{ "symbol": "NASDAQ:NDX", "width": "100%", "colorTheme": "dark", "isTransparent": true, "locale": "en" }
                  </script>
                </div>
              </div>

              <div class="tile">
                <div class="tile-top">
                  <div class="label">EURUSD</div><div class="chip">FX</div>
                </div>
                <div class="tradingview-widget-container">
                  <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
{ "symbol": "OANDA:EURUSD", "width": "100%", "colorTheme": "dark", "isTransparent": true, "locale": "en" }
                  </script>
                </div>
              </div>

              <div class="tile">
                <div class="tile-top">
                  <div class="label">BTC</div><div class="chip">Crypto</div>
                </div>
                <div class="tradingview-widget-container">
                  <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
{ "symbol": "COINBASE:BTCUSD", "width": "100%", "colorTheme": "dark", "isTransparent": true, "locale": "en" }
                  </script>
                </div>
              </div>
            </div>

            <div class="note">Live quotes via TradingView.</div>
          </aside>
        </div>

        <div class="scroll-cue">
          <a class="scroll-link" href="#below">Explore ↓ <span style="opacity:.9">Scroll</span></a>
        </div>
      </div>
    </section>

    <div id="below"></div>

    <section class="panel" id="watch" aria-label="Watchlist">
      <div class="panel-head">
        <div>
          <div class="ptitle">Live watchlist</div>
          <div class="psub">Tap a market → chart loads.</div>
        </div>
        <div class="ptime">Interactive</div>
      </div>

      <div class="watch-row">
        <button class="watch-btn active" data-symbol="FOREXCOM:SPXUSD">SPX</button>
        <button class="watch-btn" data-symbol="NASDAQ:NDX">NDX</button>
        <button class="watch-btn" data-symbol="OANDA:EURUSD">EURUSD</button>
        <button class="watch-btn" data-symbol="COINBASE:BTCUSD">BTC</button>
        <button class="watch-btn" data-symbol="OANDA:XAUUSD">GOLD</button>
      </div>

      <div class="tradingview-widget-container" id="watch-widget"></div>
      <div class="note">If TradingView is blocked on a network, charts may not load.</div>
    </section>

    <section class="panel" id="premium" aria-label="Premium tools">
      <div class="panel-head">
        <div>
          <div class="ptitle">Premium tools</div>
          <div class="psub">Members only (gated).</div>
        </div>
        <div class="ptime">Members</div>
      </div>

      <div class="subscribe-card">
        <div style="display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; align-items:baseline">
          <div>
            <div class="label" style="margin-bottom:6px">FinTrend Portfolio</div>
            <div style="font-size:16px; font-weight:800; color:#e5e7eb">Open the member dashboard</div>
          </div>
          <div class="chip">Premium</div>
        </div>

        <div class="note" style="margin-top:10px">
          This button will send premium users to <strong>premium.html</strong>. Non-premium users get the checkout link.
        </div>

        <div class="modal-row" style="margin-top:12px">
          <a class="mbtn-primary" href="#" id="open-premium-dashboard">Open Premium Dashboard</a>
          <a class="mbtn-secondary" href="#" id="manage-membership">Manage Membership</a>
        </div>

        <div class="fineprint" id="premium-status">Sign in to check access.</div>
      </div>
    </section>

    <section class="panel" id="subscribe" aria-label="Subscribe">
      <div class="panel-head">
        <div>
          <div class="ptitle">Subscribe</div>
          <div class="psub">Make this the cleanest part of the page.</div>
        </div>
        <div class="ptime">Free</div>
      </div>

      <div class="subscribe-wrap">
        <div class="subscribe-card">
          <div class="subscribe-title">Get FinTrend News</div>
          <div class="subscribe-sub">Sell-side style market notes. 4× per week. Free. No spam.</div>

          <div class="bullets">
            <div class="b"><div class="dot"></div><div class="btxt">Macro drivers + positioning, in plain English.</div></div>
            <div class="b"><div class="dot"></div><div class="btxt">Fast read: 2–4 minutes. Save the time.</div></div>
            <div class="b"><div class="dot"></div><div class="btxt">Archive calendar stays up-to-date as you publish.</div></div>
          </div>
        </div>

        <div class="form">
          <form
            action="https://github.us1.list-manage.com/subscribe/post?u=f93d4125631bb82d0915cc5d5&amp;id=0ad7096e52&amp;f_id=00addae4f0"
            method="post"
            target="_blank"
            novalidate
            style="display:flex; gap:10px; flex-wrap:wrap; width:100%; align-items:center"
          >
            <input class="input" type="email" name="EMAIL" placeholder="you@email.com" required />

            <div style="position:absolute; left:-5000px" aria-hidden="true">
              <input type="text" name="b_f93d4125631bb82d0915cc5d5_0ad7096e52" tabindex="-1" value="" />
            </div>

            <button class="submit" type="submit">Get the Brief</button>
          </form>

          <div class="fineprint">Opens Mailchimp in a new tab so your landing page never “goes blank”.</div>
        </div>
      </div>
    </section>

    <footer>
      <p style="max-width:760px; margin:0 auto 8px;">
        <strong>Disclaimer:</strong> Informational / educational only. Not financial advice.
      </p>
      <p>© 2026 FinTrend News · <a href="archive.html">Archive / Calendar</a></p>
    </footer>
  </div>

  <div id="auth-modal" class="modal-backdrop" aria-hidden="true">
    <div class="modal-window" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title">
      <button class="modal-close" id="close-auth-modal" aria-label="Close">×</button>
      <div class="modal-kicker">FinTrend Account</div>
      <h2 class="modal-title" id="auth-modal-title">Sign in</h2>
      <p class="modal-subtitle" id="auth-subtitle">Sign in to access premium tools.</p>

      <form id="auth-form" style="display:flex;flex-direction:column;gap:10px;margin-top:10px;">
        <input id="auth-email" class="field" type="email" placeholder="Email" required />
        <input id="auth-password" class="field" type="password" placeholder="Password" required />
        <div class="modal-row">
          <button type="submit" class="mbtn-primary" id="auth-submit-btn">Sign in</button>
          <button type="button" class="mbtn-secondary" id="auth-toggle-btn">Create account</button>
        </div>
        <div id="auth-msg" style="margin-top:6px;font-size:12px;color:#e5e7eb;"></div>
      </form>

      <div style="margin-top:12px;border-top:1px solid rgba(148,163,184,.25);padding-top:12px;">
        <button type="button" class="mbtn-secondary" id="auth-reset-btn" style="width:100%;">Forgot password</button>
      </div>
    </div>
  </div>

  <div id="premium-modal" class="modal-backdrop" aria-hidden="true">
    <div class="modal-window" role="dialog" aria-modal="true" aria-labelledby="premium-modal-title">
      <button class="modal-close" id="close-premium-modal" aria-label="Close">×</button>
      <div class="modal-kicker">FinTrend Premium</div>
      <h2 class="modal-title" id="premium-modal-title">Upgrade</h2>
      <p class="modal-subtitle">Unlock member tools and trade-ready notes.</p>
      <div class="modal-row">
        <a href="#" class="mbtn-primary" id="go-premium-checkout">Go Premium</a>
        <a href="#subscribe" class="mbtn-secondary" id="go-free-subscribe">Keep Free</a>
      </div>
      <div class="fineprint" style="margin-top:10px">If you haven’t set your payment link yet, this will show a message (no blank pages).</div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Smooth anchor scroll (never breaks if section missing)
      document.querySelectorAll('a[href^="#"]').forEach(a => {
        a.addEventListener("click", (e) => {
          const id = a.getAttribute("href");
          if (!id || id === "#") return;
          const el = document.querySelector(id);
          if (!el) return;
          e.preventDefault();
          el.scrollIntoView({ behavior: "smooth", block: "start" });
        });
      });

      // TradingView watch chart
      const watchWrap = document.getElementById("watch-widget");
      const buttons = document.querySelectorAll(".watch-btn");
      const loadMiniChart = (symbol) => {
        if (!watchWrap) return;
        watchWrap.innerHTML = "";
        const s = document.createElement("script");
        s.type = "text/javascript";
        s.src = "https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js";
        s.async = true;
        s.innerHTML = JSON.stringify({
          symbol,
          width: "100%",
          height: 260,
          locale: "en",
          dateRange: "3M",
          colorTheme: "dark",
          isTransparent: true,
          autosize: true
        });
        watchWrap.appendChild(s);
      };
      buttons.forEach(btn => {
        btn.addEventListener("click", () => {
          buttons.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          loadMiniChart(btn.dataset.symbol);
        });
      });
      loadMiniChart("FOREXCOM:SPXUSD");

      // Premium modal
      const premiumModal = document.getElementById("premium-modal");
      const openPremiumBtn = document.getElementById("open-premium-modal");
      const closePremiumBtn = document.getElementById("close-premium-modal");
      const freeBtn = document.getElementById("go-free-subscribe");

      const openPremiumModal = (e) => {
        if (e) e.preventDefault();
        if (!premiumModal) return;
        premiumModal.classList.add("active");
        premiumModal.setAttribute("aria-hidden", "false");
      };
      const closePremiumModal = () => {
        if (!premiumModal) return;
        premiumModal.classList.remove("active");
        premiumModal.setAttribute("aria-hidden", "true");
      };
      if (openPremiumBtn) openPremiumBtn.addEventListener("click", openPremiumModal);
      if (closePremiumBtn) closePremiumBtn.addEventListener("click", closePremiumModal);
      if (freeBtn) freeBtn.addEventListener("click", () => closePremiumModal());
      if (premiumModal) premiumModal.addEventListener("click", (e) => { if (e.target === premiumModal) closePremiumModal(); });

      // Payment link: prevent blank pages if you haven’t set it yet
      const PAYMENT_LINK = "https://your-payment-link.com";
      const safeOpenPayment = () => {
        if (!PAYMENT_LINK || PAYMENT_LINK.includes("your-payment-link.com")) {
          alert("Add your real Stripe payment link in PAYMENT_LINK inside index.html.");
          return;
        }
        window.open(PAYMENT_LINK, "_blank", "noopener");
      };
      const goPremiumCheckout = document.getElementById("go-premium-checkout");
      if (goPremiumCheckout) goPremiumCheckout.addEventListener("click", (e) => { e.preventDefault(); safeOpenPayment(); });

      // Auth modal + Supabase (guarded so the whole page never breaks)
      const authModal = document.getElementById("auth-modal");
      const openAuthBtn = document.getElementById("open-auth-modal");
      const closeAuthBtn = document.getElementById("close-auth-modal");

      const authForm = document.getElementById("auth-form");
      const authEmail = document.getElementById("auth-email");
      const authPassword = document.getElementById("auth-password");
      const authMsg = document.getElementById("auth-msg");
      const authTitle = document.getElementById("auth-modal-title");
      const authSubtitle = document.getElementById("auth-subtitle");
      const authSubmitBtn = document.getElementById("auth-submit-btn");
      const authToggleBtn = document.getElementById("auth-toggle-btn");
      const authResetBtn = document.getElementById("auth-reset-btn");

      const signoutLink = document.getElementById("signout-link");
      const userChip = document.getElementById("user-chip");

      const openPremiumDashboard = document.getElementById("open-premium-dashboard");
      const manageMembership = document.getElementById("manage-membership");
      const premiumStatus = document.getElementById("premium-status");

      const openAuthModal = (e) => {
        if (e) e.preventDefault();
        if (!authModal) return;
        authModal.classList.add("active");
        authModal.setAttribute("aria-hidden", "false");
        if (authMsg) authMsg.textContent = "";
      };
      const closeAuthModal = () => {
        if (!authModal) return;
        authModal.classList.remove("active");
        authModal.setAttribute("aria-hidden", "true");
        if (authMsg) authMsg.textContent = "";
      };

      if (openAuthBtn) openAuthBtn.addEventListener("click", openAuthModal);
      if (closeAuthBtn) closeAuthBtn.addEventListener("click", closeAuthModal);
      if (authModal) authModal.addEventListener("click", (e) => { if (e.target === authModal) closeAuthModal(); });

      // If Supabase fails to load, disable auth features without breaking the page
      if (!window.supabase || !window.supabase.createClient) {
        if (openAuthBtn) openAuthBtn.style.display = "none";
        if (premiumStatus) premiumStatus.textContent = "Auth disabled: Supabase library did not load.";
        return;
      }

      const SUPABASE_URL = "https://dxmdyperxyydqdshazcp.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR4bWR5cGVyeHl5ZHFkc2hhemNwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NjMyNDQsImV4cCI6MjA4NDUzOTI0NH0.nMKF2wi8FWX0eYrDzSyJE_CPl8XgSMx27fPlcZ9gVzI";
      const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      let mode = "signin";
      const setAuthMode = (m) => {
        mode = m;
        if (!authTitle || !authSubtitle || !authSubmitBtn || !authToggleBtn) return;
        if (mode === "signin") {
          authTitle.textContent = "Sign in";
          authSubtitle.textContent = "Sign in to access premium tools.";
          authSubmitBtn.textContent = "Sign in";
          authToggleBtn.textContent = "Create account";
        } else {
          authTitle.textContent = "Create account";
          authSubtitle.textContent = "Create an account to unlock premium tools after you subscribe.";
          authSubmitBtn.textContent = "Sign up";
          authToggleBtn.textContent = "I already have an account";
        }
        if (authMsg) authMsg.textContent = "";
      };

      if (authToggleBtn) authToggleBtn.addEventListener("click", () => setAuthMode(mode === "signin" ? "signup" : "signin"));

      if (authResetBtn) {
        authResetBtn.addEventListener("click", async () => {
          const email = (authEmail?.value || "").trim();
          if (!email) { if (authMsg) authMsg.textContent = "Enter your email above first."; return; }
          if (authMsg) authMsg.textContent = "Sending reset email...";
          const { error } = await supabase.auth.resetPasswordForEmail(email, { redirectTo: window.location.origin });
          if (authMsg) authMsg.textContent = error ? ("Reset failed: " + error.message) : "Reset email sent. Check your inbox.";
        });
      }

      if (authForm) {
        authForm.addEventListener("submit", async (e) => {
          e.preventDefault();
          if (authMsg) authMsg.textContent = "Working...";
          const email = (authEmail?.value || "").trim();
          const password = authPassword?.value || "";
          try {
            if (mode === "signin") {
              const { error } = await supabase.auth.signInWithPassword({ email, password });
              if (error) throw error;
              if (authMsg) authMsg.textContent = "Signed in ✅";
              closeAuthModal();
              await refreshUI();
            } else {
              const { error } = await supabase.auth.signUp({ email, password });
              if (error) throw error;
              if (authMsg) authMsg.textContent = "Account created ✅ (check email if confirmations are on)";
              await refreshUI();
            }
          } catch (err) {
            if (authMsg) authMsg.textContent = "Error: " + (err?.message || "Unknown error");
          }
        });
      }

      if (signoutLink) {
        signoutLink.addEventListener("click", async (e) => {
          e.preventDefault();
          await supabase.auth.signOut();
          await refreshUI();
        });
      }

      const ensureProfile = async (user) => {
        if (!user) return null;
        const { data: existing } = await supabase.from("profiles").select("id,email,is_premium").eq("id", user.id).maybeSingle();
        if (existing) return existing;
        const { data: created } = await supabase
          .from("profiles")
          .insert([{ id: user.id, email: user.email, is_premium: false }])
          .select("id,email,is_premium")
          .single();
        return created || null;
      };

      const getProfile = async (user) => {
        if (!user) return null;
        const { data } = await supabase.from("profiles").select("id,email,is_premium").eq("id", user.id).maybeSingle();
        return data || null;
      };

      const refreshUI = async () => {
        const { data } = await supabase.auth.getUser();
        const user = data?.user || null;

        if (!user) {
          if (openAuthBtn) openAuthBtn.style.display = "";
          if (signoutLink) signoutLink.style.display = "none";
          if (userChip) userChip.style.display = "none";
          if (premiumStatus) premiumStatus.textContent = "Sign in to check access.";
          return;
        }

        if (openAuthBtn) openAuthBtn.style.display = "none";
        if (signoutLink) signoutLink.style.display = "";
        if (userChip) { userChip.style.display = ""; userChip.textContent = "Signed in: " + (user.email || "user"); }

        await ensureProfile(user);
        const profile = await getProfile(user);

        if (profile && profile.is_premium) premiumStatus.textContent = "Premium: active ✅";
        else if (profile) premiumStatus.textContent = "Premium: not active (subscribe to unlock)";
        else premiumStatus.textContent = "Premium status unavailable (profiles table blocked or missing).";
      };

      if (openPremiumDashboard) {
        openPremiumDashboard.addEventListener("click", async (e) => {
          e.preventDefault();
          const { data } = await supabase.auth.getUser();
          const user = data?.user || null;
          if (!user) { openAuthModal(); return; }
          const profile = await getProfile(user);
          if (profile && profile.is_premium) window.location.href = "premium.html";
          else safeOpenPayment();
        });
      }

      if (manageMembership) manageMembership.addEventListener("click", (e) => { e.preventDefault(); safeOpenPayment(); });

      supabase.auth.onAuthStateChange(() => refreshUI());
      setAuthMode("signin");
      refreshUI();
    });
  </script>
</body>
</html>
