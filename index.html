<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FinTrend News</title>

  <link rel="icon" type="image/png" href="assets/img/favicon.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KSK5YVPJBR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-KSK5YVPJBR');
  </script>

  <!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

  <style>
    :root{
      --bg:#050816;
      --panel: rgba(15, 23, 42, 0.88);
      --panel2: rgba(2, 6, 23, 0.38);
      --text:#f9fafb;
      --muted:#9ca3af;
      --border: rgba(148, 163, 184, 0.28);
      --accent:#f4c15d;
      --accent2: rgba(244,193,93,0.12);
      --radius: 22px;
      --shadow: 0 18px 45px rgba(0,0,0,0.45);
      --max: 1150px;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      color:var(--text);
      background:
        radial-gradient(circle at top, rgba(17, 24, 39, 0.72) 0, rgba(2, 6, 23, 0.88) 45%, rgba(0,0,0,0.92) 100%),
        url("assets/img/bg-candles.png");
      background-size:cover;
      background-position:center;
      background-attachment:fixed;
      line-height:1.6;
    }

    a{color:inherit;text-decoration:none}
    a:hover{color:var(--accent)}

    .wrap{max-width:var(--max);margin:16px auto 70px;padding:0 16px}

    /* Sticky header */
    header{
      position:sticky;top:0;z-index:9999;
      border:1px solid rgba(148, 163, 184, 0.20);
      border-radius: var(--radius);
      overflow:hidden;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.84));
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 24px rgba(0,0,0,0.35);
      margin-bottom:14px;
    }

    .ticker{
      border-bottom:1px solid rgba(148, 163, 184, 0.22);
      background: radial-gradient(circle at top, #020617 0, #000 65%);
      padding:6px 16px;
    }

    .headerRow{
      display:grid;
      grid-template-columns:auto 1fr auto;
      gap:14px;
      align-items:center;
      padding:14px 18px;
    }

    .logo{height:50px;width:auto;display:block}

    .brand{
      text-align:center;
    }
    .brand h1{
      font-family:"Playfair Display",serif;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-size:30px;
      line-height:1.05;
      color:var(--accent);
    }
    .brand p{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.14em;
      text-transform:uppercase;
    }

    .nav{
      display:flex;gap:14px;flex-wrap:wrap;justify-content:flex-end;align-items:center;
    }

    .navLink{
      font-size:12px;color:var(--muted);
      letter-spacing:.10em;text-transform:uppercase;
      cursor:pointer;
    }

    .btn{
      border:0;
      cursor:pointer;
      border-radius:999px;
      padding:9px 14px;
      font-size:12px;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-weight:900;
      transition: .18s ease;
    }
    .btnPrimary{background:var(--accent);color:#000;box-shadow: 0 12px 28px rgba(244,193,93,0.16);}
    .btnPrimary:hover{background:#f7d680;transform:translateY(-1px)}
    .btnGhost{
      background: rgba(2,6,23,0.35);
      border:1px solid rgba(148, 163, 184, 0.30);
      color: var(--text);
      font-weight:800;
    }
    .btnGhost:hover{border-color:rgba(244,193,93,0.38);transform:translateY(-1px)}

    .chip{
      display:none;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.28);
      background:rgba(2,6,23,0.35);
      color:var(--muted);
      max-width:280px;
      overflow:hidden;
      white-space:nowrap;
      text-overflow:ellipsis;
      font-size:12px;
    }
    .chipDot{width:7px;height:7px;border-radius:999px;background:rgba(148,163,184,0.5);box-shadow:0 0 0 4px rgba(148,163,184,0.12)}
    .chip.premium .chipDot{background:rgba(147,197,253,0.95);box-shadow:0 0 0 4px rgba(147,197,253,0.12)}

    @media (max-width:850px){
      .headerRow{grid-template-columns:1fr;justify-items:start}
      .brand{text-align:left}
      .nav{justify-content:flex-start}
    }

    /* Panels */
    .panel{
      background: var(--panel);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
      margin-top:16px;
      position:relative;
      overflow:hidden;
      backdrop-filter: blur(6px);
    }
    .panel::before{
      content:"";
      position:absolute;
      inset:-35%;
      background: radial-gradient(circle at top left, rgba(244,193,93,0.10), transparent 55%);
      pointer-events:none;
      opacity:.85;
    }

    .panelHead{
      position:relative;z-index:1;
      display:flex;justify-content:space-between;gap:14px;flex-wrap:wrap;
      margin-bottom:12px;
    }
    .kicker{
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.16em;
      font-size:12px;
    }
    .subk{
      color:var(--muted);
      font-size:12px;
    }

    /* HERO */
    .heroGrid{
      position:relative;z-index:1;
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap:14px;
      align-items:stretch;
    }
    @media (max-width:920px){
      .heroGrid{grid-template-columns:1fr}
    }

    .heroCopy h2{
      font-family:"Playfair Display",serif;
      font-size:42px;
      line-height:1.08;
      margin-bottom:10px;
    }
    .heroCopy h2 span{
      background:linear-gradient(135deg,#fef3c7,#fbbf24,#fb923c);
      -webkit-background-clip:text;
      color:transparent;
    }
    .heroCopy p{
      color:#e5e7eb;
      font-size:15px;
      max-width:62ch;
      margin-bottom:12px;
    }

    .heroActions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }

    .reassure{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }

    /* Right column cards */
    .rightStack{
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    /* Premium spinning orb card */
    .premiumSpin{
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.35);
      padding:14px;
      position:relative;
      overflow:hidden;
      min-height:150px;
    }
    .premiumSpin::before{
      content:"";
      position:absolute;
      inset:-55%;
      background: radial-gradient(circle at 30% 20%, rgba(147,197,253,0.16), transparent 55%),
                  radial-gradient(circle at 70% 60%, rgba(244,193,93,0.12), transparent 55%);
      pointer-events:none;
      opacity:.95;
    }
    .orb{
      position:absolute;
      right:-26px;
      top:-26px;
      width:180px;
      height:180px;
      border-radius:999px;
      border:1px solid rgba(147,197,253,0.28);
      background:
        radial-gradient(circle at 35% 35%, rgba(147,197,253,0.35), rgba(2,6,23,0.0) 55%),
        radial-gradient(circle at 70% 70%, rgba(244,193,93,0.18), rgba(2,6,23,0.0) 55%);
      box-shadow:
        inset 0 0 0 10px rgba(147,197,253,0.06),
        0 18px 50px rgba(0,0,0,0.35);
      animation: orbspin 12s linear infinite;
      pointer-events:none;
      opacity:.95;
    }
    .orb::after{
      content:"";
      position:absolute;
      inset:18px;
      border-radius:999px;
      border:1px dashed rgba(244,193,93,0.28);
      animation: orbspin 8s linear infinite reverse;
      opacity:.9;
    }
    @keyframes orbspin { from{transform:rotate(0)} to{transform:rotate(360deg)} }

    .premiumInner{
      position:relative;
      z-index:1;
    }
    .premiumTitle{
      font-family:"Playfair Display",serif;
      font-size:22px;
      line-height:1.15;
      margin:6px 0 6px;
    }
    .premiumText{
      font-size:13px;
      color:#d1d5db;
      max-width:52ch;
      margin-bottom:10px;
    }

    /* Market chart card */
    .rotCard{
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.35);
      padding:12px;
      position:relative;
      overflow:hidden;
    }
    .rotTop{
      display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;
      margin-bottom:10px;
    }
    .rotTitle{
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .rotNow{
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--accent);
    }
    .rotRing{
      position:absolute;
      top:-40px; right:-40px;
      width:140px;height:140px;border-radius:999px;
      border:1px solid rgba(244,193,93,0.28);
      box-shadow: inset 0 0 0 10px rgba(244,193,93,0.06);
      animation: spin 10s linear infinite;
      pointer-events:none;
      opacity:.8;
    }
    @keyframes spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }

    /* Week interactive */
    .weekGrid{
      position:relative;z-index:1;
      display:grid;
      grid-template-columns: 0.95fr 1.05fr;
      gap:14px;
      align-items:stretch;
    }
    @media (max-width:980px){.weekGrid{grid-template-columns:1fr}}

    .weekLeft{
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.35);
      padding:16px;
    }
    .weekLeft h3{
      font-family:"Playfair Display",serif;
      font-size:24px;
      line-height:1.15;
      margin:6px 0 8px;
    }
    .weekLeft p{color:#d1d5db;font-size:13px;max-width:60ch}

    .dayPills{
      display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;
    }
    .pill{
      border:1px solid rgba(148,163,184,0.28);
      background: rgba(2,6,23,0.30);
      color:var(--muted);
      border-radius:999px;
      padding:8px 12px;
      cursor:pointer;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      transition:.18s ease;
      user-select:none;
    }
    .pill:hover{transform:translateY(-1px);border-color:rgba(244,193,93,0.35)}
    .pill.active{
      border-color: rgba(244,193,93,0.55);
      background: rgba(244,193,93,0.10);
      color: var(--accent);
      box-shadow: 0 0 0 4px rgba(244,193,93,0.08);
    }

    .weekRight{
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.35);
      padding:16px;
      overflow:hidden;
      position:relative;
    }
    .weekRight::before{
      content:"";
      position:absolute;inset:-40%;
      background: radial-gradient(circle at top right, rgba(244,193,93,0.12), transparent 55%);
      pointer-events:none;
      opacity:.8;
    }
    .weekCard{
      position:relative;z-index:1;
      border-radius:16px;
      border:1px solid rgba(148,163,184,0.20);
      background: rgba(15,23,42,0.62);
      padding:14px;
    }
    .weekCardTop{
      display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:baseline;
      margin-bottom:8px;
    }
    .weekLabel{
      font-weight:900;color:#e5e7eb;font-size:18px;line-height:1.2;
    }
    .weekMeta{
      font-size:11px;color:var(--muted);
      letter-spacing:.14em;text-transform:uppercase;
      border:1px solid rgba(148,163,184,0.26);
      background: rgba(2,6,23,0.30);
      padding:4px 8px;border-radius:999px;
    }
    .weekDesc{color:#d1d5db;font-size:13px;margin-bottom:10px}
    .weekBullets{padding-left:16px;color:#e5e7eb;font-size:12px}
    .weekBullets li{margin-bottom:6px}

    /* Charts under week */
    .chartRow{
      position:relative;z-index:1;
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px;
    }
    .watchBtn{
      border:1px solid rgba(148,163,184,0.30);
      background: rgba(2,6,23,0.35);
      color: var(--text);
      border-radius: 999px;
      padding:8px 12px;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
      transition:.18s ease;
    }
    .watchBtn:hover{transform:translateY(-1px);border-color:rgba(244,193,93,0.35)}
    .watchBtn.active{border-color: rgba(244,193,93,0.55); background: rgba(244,193,93,0.10); color: var(--accent)}

    .chartBox{
      margin-top:10px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.25);
      border-radius: 18px;
      padding:10px;
      overflow:hidden;
    }

    /* Deep dive section */
    .grid2{
      position:relative;z-index:1;
      display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;
    }
    @media (max-width:900px){.grid2{grid-template-columns:1fr}}
    .card{
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.35);
      padding:16px;
      transition:.18s ease;
    }
    .card:hover{transform:translateY(-2px);border-color:rgba(244,193,93,0.35)}
    .cardTag{font-size:11px;color:var(--muted);letter-spacing:.16em;text-transform:uppercase;margin-bottom:8px}
    .cardTitle{font-size:16px;font-weight:900;line-height:1.25;margin-bottom:8px;color:#e5e7eb}
    .cardText{font-size:12px;color:var(--muted)}
    .cardText ul{margin-top:8px;padding-left:16px;color:#e5e7eb}
    .cardText li{margin-bottom:6px}

    footer{
      margin-top:22px;
      text-align:center;
      color: var(--muted);
      font-size:11px;
    }

    /* Modals */
    .modalBackdrop{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,0.62);
      z-index:100000;
      padding:14px;
    }
    .modalBackdrop.active{display:flex}
    .modal{
      width:100%;
      max-width:460px;
      border-radius:24px;
      border:1px solid rgba(148,163,184,0.35);
      background: rgba(15, 23, 42, 0.97);
      box-shadow: var(--shadow);
      padding:22px 22px 18px;
      position:relative;
    }
    .modalClose{
      position:absolute; top:10px; right:12px;
      border:0;background:transparent;color:var(--muted);
      font-size:22px;cursor:pointer;
    }
    .modalK{font-size:11px;color:var(--muted);letter-spacing:.18em;text-transform:uppercase;margin-bottom:4px}
    .modalH{font-family:"Playfair Display",serif;font-size:22px;margin-bottom:6px}
    .modalP{font-size:13px;color:#d1d5db;margin-bottom:12px}
    .in{
      width:100%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,0.4);
      background:#020617;
      color:var(--text);
      font-size:12px;
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .msg{margin-top:10px;font-size:12px;color:#e5e7eb}

    /* Example briefing card (fills the empty space under the hero buttons) */
    .sampleBrief{
      margin-top:14px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.35);
      border-radius:18px;
      padding:14px;
      position:relative;
      overflow:hidden;
    }
    .sampleBrief::before{
      content:"";
      position:absolute;
      inset:-45%;
      background: radial-gradient(circle at top right, rgba(244,193,93,0.10), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }
    .sampleBriefInner{position:relative;z-index:1}
    .sampleBriefLabel{
      font-size:11px;
      color:var(--muted);
      letter-spacing:.16em;
      text-transform:uppercase;
      margin-bottom:10px;
    }
    .sampleBriefRow{
      display:flex;
      gap:12px;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .sampleBriefTag{
      font-size:11px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:var(--muted);
      min-width:92px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(2,6,23,0.25);
      line-height:1.2;
      margin-top:1px;
      white-space:nowrap;
    }
    .sampleBriefText{
      font-size:13px;
      color:#e5e7eb;
      line-height:1.45;
    }
    .sampleBriefFoot{
      font-size:11px;
      color:var(--muted);
      margin-top:8px;
      opacity:.85;
    }
    @media (max-width:520px){
      .sampleBriefRow{flex-direction:column;gap:6px}
      .sampleBriefTag{min-width:auto;align-self:flex-start}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <!-- TradingView ticker tape (motion) -->
      <div class="ticker">
        <div class="tradingview-widget-container">
          <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
{
  "symbols": [
    { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500" },
    { "proName": "NASDAQ:NDX", "title": "Nasdaq 100" },
    { "proName": "DJI", "title": "Dow 30" },
    { "proName": "RUSSELL:RTY", "title": "Russell 2000" },
    { "proName": "OANDA:EURUSD", "title": "EURUSD" },
    { "proName": "COINBASE:BTCUSD", "title": "BTCUSD" },
    { "proName": "OANDA:WTICOUSD", "title": "WTI Crude" },
    { "proName": "OANDA:XAUUSD", "title": "Gold" }
  ],
  "colorTheme": "dark",
  "isTransparent": true,
  "displayMode": "adaptive",
  "locale": "en"
}
          </script>
        </div>
      </div>

      <div class="headerRow">
        <img src="assets/img/FTN-logo.png" class="logo" alt="FinTrend News logo" />

        <div class="brand">
          <h1>FinTrend News</h1>
          <p>Market briefing, not noise</p>
        </div>

        <div class="nav">
          <a class="navLink" href="archive.html">Read Free Articles</a>
          <a class="navLink" href="#week">Week Map</a>
          <a class="navLink" href="#deepdive">Deep Dives</a>

          <a class="navLink" href="#" id="open-auth">Sign In</a>
          <a class="navLink" href="#" id="signout" style="display:none;">Sign Out</a>

          <div class="chip" id="chip">
            <span class="chipDot"></span>
            <span id="chipText">Signed in</span>
          </div>

          <button class="btn btnPrimary" id="cta-create">Create Free Account</button>
        </div>
      </div>
    </header>

    <!-- HERO -->
    <section class="panel" id="top">
      <div class="panelHead">
        <div>
          <div class="kicker">The homepage goal</div>
          <div class="subk">Account creation first. Reading free stays secondary.</div>
        </div>
      </div>

      <div class="heroGrid">
        <!-- Left copy -->
        <div class="heroCopy">
          <h2>A <span>market brief</span> built for fast decisions.</h2>
          <p>
            Clear drivers → implications → levels. No long story. Just what matters and what changes the view.
          </p>

          <div class="heroActions">
            <button class="btn btnPrimary" id="cta-create-2">Create Free Account</button>
            <a class="btn btnGhost" href="archive.html">Read Free Articles</a>
          </div>

          <!-- Filled “empty space” with an evergreen sample (no daily updates needed) -->
          <div class="sampleBrief" aria-label="Example Briefing Format">
            <div class="sampleBriefInner">
              <div class="sampleBriefLabel">Example Briefing Format</div>

              <div class="sampleBriefRow">
                <div class="sampleBriefTag">Driver</div>
                <div class="sampleBriefText">Inflation surprise shifts rate expectations.</div>
              </div>

              <div class="sampleBriefRow">
                <div class="sampleBriefTag">Bias</div>
                <div class="sampleBriefText">Short-term risk-off while yields stabilize.</div>
              </div>

              <div class="sampleBriefRow">
                <div class="sampleBriefTag">Key Levels</div>
                <div class="sampleBriefText">Support / resistance zones to monitor.</div>
              </div>

              <div class="sampleBriefRow" style="margin-bottom:0;">
                <div class="sampleBriefTag">Catalyst</div>
                <div class="sampleBriefText">Upcoming central bank commentary.</div>
              </div>

              <div class="sampleBriefFoot">*Illustrative example. Educational content only.</div>
            </div>
          </div>

          <div class="reassure">No credit card • Email used for login</div>
        </div>

        <!-- Right: Premium spin + manual market chart (NOT rotating, NDX removed here) -->
        <div class="rightStack">
          <div class="premiumSpin">
            <div class="orb"></div>
            <div class="premiumInner">
              <div class="kicker">Premium</div>
              <div class="premiumTitle">Premium Deep Dives</div>
              <div class="premiumText">
                Long-form sector reports: drivers, positioning, catalysts, and levels — built like a playbook.
              </div>
              <div class="row">
                <button class="btn btnPrimary" id="goPremiumTop">View Premium</button>
                <a class="btn btnGhost" href="#deepdive">What is a Deep Dive?</a>
              </div>
              <div class="reassure" id="premiumStatusTop">Sign in to check access.</div>
            </div>
          </div>

          <div class="rotCard">
            <div class="rotRing"></div>
            <div class="rotTop">
              <div class="rotTitle">Market chart</div>
              <div class="rotNow" id="rotNow">SPX</div>
            </div>

            <div class="chartRow" style="margin-top:0;">
              <button class="watchBtn active" data-rot="FOREXCOM:SPXUSD" data-label="SPX">SPX</button>
              <button class="watchBtn" data-rot="OANDA:EURUSD" data-label="EURUSD">EURUSD</button>
              <button class="watchBtn" data-rot="COINBASE:BTCUSD" data-label="BTC">BTC</button>
              <button class="watchBtn" data-rot="OANDA:XAUUSD" data-label="Gold">Gold</button>
            </div>

            <div class="chartBox">
              <div id="rotChart"></div>
            </div>

            <div class="reassure" style="margin-top:10px;">
              Tap a market to load the chart.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- WEEK MAP -->
    <section class="panel" id="week">
      <div class="panelHead">
        <div>
          <div class="kicker">Week map</div>
          <div class="subk">Interactive: what you get on Monday / Wednesday / Friday / Sunday</div>
        </div>
      </div>

      <div class="weekGrid">
        <div class="weekLeft">
          <div class="kicker">Same framework • different job</div>
          <h3>4 formats so you always know what you’re getting.</h3>
          <p>
            Pick a day. The card updates instantly. This is designed to make the schedule feel real (and worth signing up for),
            without talking about premium or payments.
          </p>

          <div class="dayPills">
            <button class="pill active" data-day="mon">Mon</button>
            <button class="pill" data-day="wed">Wed</button>
            <button class="pill" data-day="fri">Fri</button>
            <button class="pill" data-day="sun">Sun</button>
          </div>

          <div class="heroActions" style="margin-top:14px;">
            <button class="btn btnPrimary" id="cta-create-3">Create Free Account</button>
            <a class="btn btnGhost" href="archive.html">Read Free Articles</a>
          </div>

          <div class="reassure">No credit card • Email used for login</div>
        </div>

        <div class="weekRight">
          <div class="weekCard" id="weekCard"></div>

          <div style="margin-top:14px;position:relative;z-index:1;">
            <div class="kicker">Charts</div>
            <div class="subk">Tap a market to load a chart (fast).</div>

            <div class="chartRow">
              <button class="watchBtn active" data-symbol="FOREXCOM:SPXUSD">SPX</button>
              <button class="watchBtn" data-symbol="NASDAQ:NDX">NDX</button>
              <button class="watchBtn" data-symbol="OANDA:EURUSD">EURUSD</button>
              <button class="watchBtn" data-symbol="COINBASE:BTCUSD">BTC</button>
              <button class="watchBtn" data-symbol="OANDA:XAUUSD">Gold</button>
            </div>

            <div class="chartBox">
              <div id="watchChart"></div>
              <div id="watchFallback" class="reassure" style="display:none;margin-top:10px;">
                Chart didn’t load. <a id="watchOpenTV" href="#" target="_blank" rel="noopener">Open on TradingView ↗</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Deep Dive explanation section -->
    <section class="panel" id="deepdive">
      <div class="panelHead">
        <div>
          <div class="kicker">Deep Dives</div>
          <div class="subk">A specific sector or trending theme — built like a playbook.</div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="cardTag">What it is</div>
          <div class="cardTitle">A Deep Dive = one topic, fully mapped.</div>
          <div class="cardText">
            This is not “news.” It’s a focused report on a sector/theme/trend:
            <ul>
              <li><strong>Driver:</strong> what’s actually moving it</li>
              <li><strong>Winners/Losers:</strong> who benefits + who gets hurt</li>
              <li><strong>Catalysts:</strong> what events change the story</li>
              <li><strong>Levels:</strong> the “if this breaks, we’re wrong” points</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <div class="cardTag">Premium (unchanged logic)</div>
          <div class="cardTitle">Premium Deep Dives</div>
          <div class="cardText">
            If you’re premium, you go to the dashboard. If not, you’ll see the upgrade.
            <div class="row" style="margin-top:12px;">
              <button class="btn btnPrimary" id="goPremium">View premium</button>
              <a class="btn btnGhost" href="archive.html">Stay on free</a>
            </div>
            <div class="reassure" id="premiumStatus" style="margin-top:10px;">Sign in to check access.</div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <p style="max-width:760px;margin:0 auto 8px;">
        <strong>Disclaimer:</strong> Informational + educational only. Not financial advice.
      </p>
      <p>© 2026 FinTrend News · <a href="archive.html">Archive</a></p>
    </footer>
  </div>

  <!-- AUTH MODAL -->
  <div class="modalBackdrop" id="authModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <button class="modalClose" id="closeAuth">×</button>
      <div class="modalK">FinTrend Account</div>
      <div class="modalH" id="authTitle">Create Free Account</div>
      <div class="modalP" id="authSubtitle">Create an account to unlock account-gated reads. No credit card.</div>

      <form id="authForm">
        <input class="in" id="email" type="email" placeholder="Email" required />
        <div style="height:10px"></div>
        <input class="in" id="password" type="password" placeholder="Password" required />

        <div class="row">
          <button class="btn btnPrimary" type="submit" id="authSubmit">Create Free Account</button>
          <button class="btn btnGhost" type="button" id="toggleMode">Already have an account?</button>
        </div>
        <div class="msg" id="authMsg"></div>
      </form>
    </div>
  </div>

  <!-- PREMIUM MODAL -->
  <div class="modalBackdrop" id="premiumModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <button class="modalClose" id="closePremium">×</button>
      <div class="modalK">FinTrend Premium</div>
      <div class="modalH">Upgrade to Premium</div>
      <div class="modalP">Premium unlocks deep dives + the members dashboard (premium.html).</div>

      <div class="row">
        <a class="btn btnPrimary" href="#" id="payLink">Go Premium</a>
        <button class="btn btnGhost" id="closePremium2" type="button">Not now</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      "use strict";

      // -----------------------------
      // Links you already use
      // -----------------------------
      const PAYMENT_LINK = "https://buy.stripe.com/aFabJ0auNdEVbnR4m2ffy00"; // unchanged
      const PREMIUM_DASHBOARD = "premium.html";
      const FREE_ACCOUNT_PAGE = "archive.html"; // where non-premium users go after sign-in

      // -----------------------------
      // Modal helpers
      // -----------------------------
      const authModal = document.getElementById("authModal");
      const premiumModal = document.getElementById("premiumModal");

      function openModal(m){ m.classList.add("active"); m.setAttribute("aria-hidden","false"); }
      function closeModal(m){ m.classList.remove("active"); m.setAttribute("aria-hidden","true"); }

      // -----------------------------
      // Elements
      // -----------------------------
      const openAuthBtn = document.getElementById("open-auth");
      const authTitle = document.getElementById("authTitle");
      const authSubtitle = document.getElementById("authSubtitle");
      const authSubmit = document.getElementById("authSubmit");
      authSubmit.disabled = false;
      const toggleModeBtn = document.getElementById("toggleMode");
      const authMsg = document.getElementById("authMsg");

      const chip = document.getElementById("chip");
      const chipText = document.getElementById("chipText");
      const signout = document.getElementById("signout");
      const openAuth = document.getElementById("open-auth");
      const premiumStatus = document.getElementById("premiumStatus");
      const premiumStatusTop = document.getElementById("premiumStatusTop");

      // Close buttons
      document.getElementById("closeAuth").addEventListener("click",()=>closeModal(authModal));
      authModal.addEventListener("click",(e)=>{ if(e.target===authModal) closeModal(authModal); });

      document.getElementById("closePremium").addEventListener("click",()=>closeModal(premiumModal));
      document.getElementById("closePremium2").addEventListener("click",()=>closeModal(premiumModal));
      premiumModal.addEventListener("click",(e)=>{ if(e.target===premiumModal) closeModal(premiumModal); });

      // -----------------------------
      // Mode switching
      // -----------------------------
      let mode = "signup";
      function setMode(m){
        mode = m;
        authMsg.textContent = "";
        if(mode === "signup"){
          authTitle.textContent = "Create Free Account";
          authSubtitle.textContent = "Create an account to unlock account-gated reads. No credit card.";
          authSubmit.textContent = "Create Free Account";
          toggleModeBtn.textContent = "Already have an account?";
        } else {
          authTitle.textContent = "Sign in";
          authSubtitle.textContent = "Sign in to continue reading and access your account.";
          authSubmit.textContent = "Sign in";
          toggleModeBtn.textContent = "Create Free Account";
        }
      }
      toggleModeBtn.addEventListener("click",()=>setMode(mode==="signup"?"signin":"signup"));

      // ✅ Sign In opens SIGNIN mode
      openAuthBtn.addEventListener("click",(e)=>{
        e.preventDefault();
        setMode("signin");
        openModal(authModal);
      });

      // ✅ Create account CTAs open SIGNUP mode
      [ "cta-create","cta-create-2","cta-create-3" ].forEach(id=>{
        const el = document.getElementById(id);
        if(el) el.addEventListener("click",()=>{ setMode("signup"); openModal(authModal); });
      });

      function humanErr(err){
        const msg = (err && err.message ? String(err.message) : "").toLowerCase();
        if (msg.includes("invalid login") || msg.includes("credentials")) return "Wrong email or password.";
        if (msg.includes("email not confirmed")) return "Confirm your email, then sign in.";
        if (msg.includes("rate limit") || msg.includes("too many")) return "Too many attempts. Try again in a minute.";
        return "Something went wrong. Try again.";
      }

      // -----------------------------
      // Week map interactive content
      // -----------------------------
      const weekData = {
        mon: {
          title: "Monday • Outlook",
          meta: "Set the week’s bias",
          desc: "Start with the driver. End with one level that changes your mind.",
          bullets: [
            "Primary driver (rates / USD / credit / oil)",
            "Base case + 1 alternative scenario",
            "Key level + invalidation"
          ]
        },
        wed: {
          title: "Wednesday • Momentum",
          meta: "Mid-week reality check",
          desc: "What’s working, what’s fading, and whether the move is healthy or crowded.",
          bullets: [
            "Leadership + rotation snapshot",
            "Crowding/stretch note (risk/reward)",
            "What must happen next for the trend to continue"
          ]
        },
        fri: {
          title: "Friday • Recap",
          meta: "What changed (for real)",
          desc: "Did the driver change? Or just the story? You get the clean answer.",
          bullets: [
            "What changed: driver vs narrative vs positioning",
            "Winners/losers (with why)",
            "Levels that matter into next week"
          ]
        },
        sun: {
          title: "Sunday • Macro Setup",
          meta: "The map into next week",
          desc: "What’s priced in, what could surprise, and the one catalyst that matters most.",
          bullets: [
            "Priced-in vs surprise framing",
            "2–3 scenarios max",
            "Catalyst calendar + watch points"
          ]
        }
      };

      const weekCard = document.getElementById("weekCard");
      function renderDay(key){
        const d = weekData[key];
        weekCard.innerHTML = `
          <div class="weekCardTop">
            <div class="weekLabel">${d.title}</div>
            <div class="weekMeta">${d.meta}</div>
          </div>
          <div class="weekDesc">${d.desc}</div>
          <ul class="weekBullets">${d.bullets.map(b=>`<li>${b}</li>`).join("")}</ul>
        `;
      }
      renderDay("mon");

      document.querySelectorAll(".pill").forEach(p=>{
        p.addEventListener("click",()=>{
          document.querySelectorAll(".pill").forEach(x=>x.classList.remove("active"));
          p.classList.add("active");
          renderDay(p.dataset.day);
        });
      });

      // -----------------------------
      // TradingView chart embedding helpers
      // -----------------------------
      function loadMiniSymbolOverview(targetId, symbol, height){
        const el = document.getElementById(targetId);
        if(!el) return;

        el.innerHTML = "";
        const s = document.createElement("script");
        s.src = "https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js";
        s.async = true;
        s.text = JSON.stringify({
          symbol,
          width: "100%",
          height: height || 280,
          locale: "en",
          dateRange: "3M",
          colorTheme: "dark",
          isTransparent: true,
          autosize: true
        });
        el.appendChild(s);
      }

      // -----------------------------
      // Right card market chart (manual buttons, NOT rotating)
      // -----------------------------
      const rotNow = document.getElementById("rotNow");
      function loadRot(symbol, label){
        if(rotNow) rotNow.textContent = label || "";
        loadMiniSymbolOverview("rotChart", symbol, 260);
      }
      loadRot("FOREXCOM:SPXUSD", "SPX");

      document.querySelectorAll("[data-rot]").forEach(btn=>{
        btn.addEventListener("click",()=>{
          const parentRow = btn.closest(".chartRow");
          if(parentRow){
            parentRow.querySelectorAll(".watchBtn").forEach(b=>b.classList.remove("active"));
          }
          btn.classList.add("active");
          loadRot(btn.getAttribute("data-rot"), btn.getAttribute("data-label"));
        });
      });

      // -----------------------------
      // Watch chart buttons (week section)
      // -----------------------------
      const watchFallback = document.getElementById("watchFallback");
      const watchOpenTV = document.getElementById("watchOpenTV");

      function showFallback(symbol){
        if(!watchFallback) return;
        watchFallback.style.display = "block";
        if(watchOpenTV){
          watchOpenTV.href = "https://www.tradingview.com/chart/?symbol=" + encodeURIComponent(symbol);
        }
      }
      function hideFallback(){
        if(!watchFallback) return;
        watchFallback.style.display = "none";
      }

      function loadWatch(symbol){
        hideFallback();
        loadMiniSymbolOverview("watchChart", symbol, 300);
        setTimeout(()=>showFallback(symbol), 2500);
      }

      loadWatch("FOREXCOM:SPXUSD");
      document.querySelectorAll(".watchBtn").forEach(btn=>{
        if(btn.hasAttribute("data-symbol")){
          btn.addEventListener("click",()=>{
            document.querySelectorAll(".watchBtn").forEach(b=>{
              if(b.hasAttribute("data-symbol")) b.classList.remove("active");
            });
            btn.classList.add("active");
            loadWatch(btn.dataset.symbol);
          });
        }
      });

      // -----------------------------
      // Supabase Auth + Premium check
      // -----------------------------
      const SUPABASE_URL = "https://dxmdyperxyydqdshazcp.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR4bWR5cGVyeHl5ZHFkc2hhemNwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NjMyNDQsImV4cCI6MjA4NDUzOTI0NH0.nMKF2wi8FWX0eYrDzSyJE_CPl8XgSMx27fPlcZ9gVzI"; // unchanged (same as your original message)

      let supabaseClient = null;

      async function checkPremium(user){
        try{
          const { data, error } = await supabaseClient
            .from("profiles")
            .select("is_premium,email")
            .eq("id", user.id)
            .maybeSingle();

          const msg = (data && data.is_premium)
            ? "Premium member ✅"
            : "Not premium — upgrade to unlock deep dives.";

          if(premiumStatus) premiumStatus.textContent = (error || !data) ? "Signed in. Premium status can’t be verified right now." : msg;
          if(premiumStatusTop) premiumStatusTop.textContent = (error || !data) ? "Signed in. Premium status can’t be verified right now." : msg;

          return !!(data && data.is_premium);
        } catch(e){
          if(premiumStatus) premiumStatus.textContent = "Signed in. Premium status can’t be verified right now.";
          if(premiumStatusTop) premiumStatusTop.textContent = "Signed in. Premium status can’t be verified right now.";
          return false;
        }
      }

      function setSignedOutUI(){
        chip.style.display = "none";
        chip.classList.remove("premium");
        openAuth.style.display = "";
        signout.style.display = "none";
        if(premiumStatus) premiumStatus.textContent = "Sign in to check access.";
        if(premiumStatusTop) premiumStatusTop.textContent = "Sign in to check access.";
      }

      function setSignedInUI(user, isPremium){
        chip.style.display = "inline-flex";
        chip.classList.toggle("premium", !!isPremium);
        chipText.textContent = (isPremium ? "Premium • " : "Signed in • ") + (user.email || "account");
        openAuth.style.display = "none";
        signout.style.display = "";
      }

      async function refreshUI(){
        const { data } = await supabaseClient.auth.getUser();
        const user = data?.user;
        if(!user){ setSignedOutUI(); return; }
        const isPremium = await checkPremium(user);
        setSignedInUI(user, isPremium);
      }

      // ✅ After SIGN IN, redirect to account:
      //    Premium -> premium.html
      //    Not premium (or cannot verify) -> archive.html
     async function redirectToAccount(passedUser){
  try{
    const user = passedUser || (await supabaseClient.auth.getUser()).data?.user;

    if(!user){
      window.location.href = FREE_ACCOUNT_PAGE;
      return;
    }

    let isPremium = false;
    try{
      isPremium = await checkPremium(user);
    } catch(_){}

    window.location.href = isPremium ? PREMIUM_DASHBOARD : FREE_ACCOUNT_PAGE;
  } catch(e){
    window.location.href = FREE_ACCOUNT_PAGE;
  }
}

      // Premium modal
      const payLink = document.getElementById("payLink");
      payLink.addEventListener("click",(e)=>{ e.preventDefault(); window.open(PAYMENT_LINK,"_blank","noopener"); });

      // Premium buttons (top + deepdive)
      document.getElementById("goPremium").addEventListener("click",(e)=>{ e.preventDefault(); routePremium(); });
      document.getElementById("goPremiumTop").addEventListener("click",(e)=>{ e.preventDefault(); routePremium(); });

      async function routePremium(){
        if(!supabaseClient){
          setMode("signin");
          openModal(authModal);
          authMsg.textContent = "Sign in first.";
          return;
        }
        const userRes = await supabaseClient.auth.getUser();
        const user = userRes.data?.user;
        if(!user){
          setMode("signup");
          openModal(authModal);
          authMsg.textContent = "Create a free account first. You can upgrade anytime.";
          return;
        }
        const isPremium = await checkPremium(user);
        if(isPremium) window.location.href = PREMIUM_DASHBOARD;
        else openModal(premiumModal);
      }

      // Init Supabase
      (async function initAuth(){
        if(!window.supabase || !window.supabase.createClient){
          console.warn("Supabase not loaded.");
          return;
        }

        supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
          auth: { persistSession:true, autoRefreshToken:true, detectSessionInUrl:true, storage: window.localStorage }
        });

        // Auth form
       document.getElementById("authForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  authMsg.textContent = "";

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value;

  if(!email || !password){
    authMsg.textContent = "Enter email + password.";
    return;
  }

  authSubmit.disabled = true;

  try{

    if(mode === "signin"){
      const { data, error } =
        await supabaseClient.auth.signInWithPassword({ email, password });

      if(error){
        authMsg.textContent = humanErr(error);
        authSubmit.disabled = false;
        return;
      }

      authMsg.textContent = "Signed in ✅";
      closeModal(authModal);

      setTimeout(() => redirectToAccount(), 0);
      return;
    }

    // SIGN UP
    const { error } =
      await supabaseClient.auth.signUp({ email, password });

    if(error){
      authMsg.textContent = humanErr(error);
      authSubmit.disabled = false;
      return;
    }

    authMsg.textContent =
      "Account created. Check email to confirm, then sign in.";

  } catch(err){
    console.error(err);
    authMsg.textContent = "Unexpected error. Try again.";
    authSubmit.disabled = false;
    return;
  }

  authSubmit.disabled = false;
});

        signout.addEventListener("click", async (e)=>{
          e.preventDefault();
          try{ await supabaseClient.auth.signOut(); } catch(_){}
          setSignedOutUI();
        });

        supabaseClient.auth.onAuthStateChange(async ()=>{ await refreshUI(); });
        await refreshUI();
      })();

      // close modals with ESC
      window.addEventListener("keydown",(e)=>{
        if(e.key === "Escape"){
          closeModal(authModal);
          closeModal(premiumModal);
        }
      });

    })();
  </script>
</body>
</html>
