<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signing you in…</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <h2>Signing you in…</h2>

  <script>
    const SUPABASE_URL = "https://dxmdyperxyydqdshazcp.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_3MtFdyI5BPbXDHWoAf9ZVQ_C9C0Gec-";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: {
        persistSession: true,
        autoRefreshToken: true,
        detectSessionInUrl: true
      }
    });

    (async () => {
      const { error } = await supabase.auth.exchangeCodeForSession(window.location.href);

      if (error) {
        document.body.innerHTML = `<h2>Sign-in failed</h2><pre>${error.message}</pre>`;
        return;
      }

      // after login, send them to premium
      window.location.href = "../premium.html";
    })();
  </script>
</body>
</html>
